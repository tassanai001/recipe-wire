# Story 1.5: Setup Next.js Frontend Skeleton

**Epic:** Epic 1 - Project Setup & Infrastructure  
**Story ID:** 1.5  
**Priority:** High  
**Estimate:** 5 Story Points  
**Sprint:** Sprint 1 (Week 1-2)

---

## Status

**Draft**

---

## Story

**As a** developer,  
**I want** a Next.js application skeleton with Tailwind CSS and shadcn/ui,  
**so that** I can start building UI components with modern styling

---

## Acceptance Criteria

1. Next.js 14+ application initialized in `apps/frontend` with App Router
2. TypeScript configured with strict mode
3. Tailwind CSS installed and configured
4. shadcn/ui initialized with base components
5. Basic layout structure created:
   - Root layout with metadata
   - Navigation component (placeholder)
   - Footer component (placeholder)
6. Home page created with basic content
7. React Query configured for server state management
8. Zustand configured for client state (auth state placeholder)
9. Application runs successfully on port 3000

---

## Tasks / Subtasks

- [ ] **Initialize Next.js Application** (AC: 1)
  - [ ] Navigate to `apps/` directory
  - [ ] Run `pnpm create next-app@latest frontend`
  - [ ] Select: TypeScript, ESLint, Tailwind CSS, App Router, src/ directory
  - [ ] Verify Next.js project structure created
  - [ ] Update package.json name to `@recipe-wire/frontend`

- [ ] **Configure TypeScript** (AC: 2)
  - [ ] Update `tsconfig.json` with strict mode enabled
  - [ ] Configure path aliases: `@/*` for `./src/*`
  - [ ] Add path aliases for shared packages
  - [ ] Set target to ES2022
  - [ ] Verify TypeScript compilation works

- [ ] **Configure Tailwind CSS** (AC: 3)
  - [ ] Verify Tailwind installed (should be from create-next-app)
  - [ ] Update `tailwind.config.js` with custom theme colors
  - [ ] Configure content paths for all components
  - [ ] Add custom colors for brand identity
  - [ ] Test Tailwind classes work in components

- [ ] **Install shadcn/ui** (AC: 4)
  - [ ] Run `pnpm dlx shadcn-ui@latest init`
  - [ ] Select default style and base color
  - [ ] Verify `components.json` created
  - [ ] Verify `lib/utils.ts` created with cn() function
  - [ ] Install base components: `pnpm dlx shadcn-ui@latest add button card input label`

- [ ] **Install Additional Dependencies** (AC: 7, 8)
  - [ ] Install React Query: `pnpm add @tanstack/react-query @tanstack/react-query-devtools`
  - [ ] Install Zustand: `pnpm add zustand`
  - [ ] Install Axios: `pnpm add axios`
  - [ ] Install date-fns: `pnpm add date-fns`
  - [ ] Verify all dependencies in package.json

- [ ] **Setup React Query** (AC: 7)
  - [ ] Create `src/lib/query-client.ts` with QueryClient configuration
  - [ ] Create `src/providers/query-provider.tsx` with QueryClientProvider
  - [ ] Wrap app with QueryClientProvider in root layout
  - [ ] Add React Query Devtools for development
  - [ ] Test React Query setup with a sample query

- [ ] **Setup Zustand Store** (AC: 8)
  - [ ] Create `src/store/auth.store.ts` for auth state
  - [ ] Define auth state interface (user, token, isAuthenticated)
  - [ ] Create actions: login, logout, setUser
  - [ ] Add persist middleware for localStorage
  - [ ] Test store with sample usage

- [ ] **Create Root Layout** (AC: 5)
  - [ ] Update `src/app/layout.tsx` with proper metadata
  - [ ] Add QueryClientProvider wrapper
  - [ ] Configure fonts (Inter or similar)
  - [ ] Add global styles
  - [ ] Include Navigation and Footer components

- [ ] **Create Navigation Component** (AC: 5)
  - [ ] Create `src/components/layout/navigation.tsx`
  - [ ] Add placeholder navigation with logo and links
  - [ ] Use shadcn/ui Button component
  - [ ] Make responsive (mobile menu placeholder)
  - [ ] Add basic styling with Tailwind

- [ ] **Create Footer Component** (AC: 5)
  - [ ] Create `src/components/layout/footer.tsx`
  - [ ] Add placeholder footer with copyright
  - [ ] Add social links placeholders
  - [ ] Add basic styling with Tailwind
  - [ ] Make responsive

- [ ] **Create Home Page** (AC: 6)
  - [ ] Update `src/app/page.tsx` with welcome content
  - [ ] Use shadcn/ui Card and Button components
  - [ ] Add hero section with project description
  - [ ] Add call-to-action buttons (placeholder links)
  - [ ] Make responsive and visually appealing

- [ ] **Setup API Client** (AC: 7)
  - [ ] Create `src/lib/api/client.ts` with Axios instance
  - [ ] Configure base URL from NEXT_PUBLIC_API_URL
  - [ ] Add request interceptor for auth token
  - [ ] Add response interceptor for error handling
  - [ ] Create sample API functions (e.g., health check)

- [ ] **Configure Environment Variables** (AC: 9)
  - [ ] Create `.env.local` with NEXT_PUBLIC_API_URL
  - [ ] Create `.env.example` with template
  - [ ] Add `.env.local` to .gitignore
  - [ ] Document environment variables in README
  - [ ] Test environment variable access

- [ ] **Setup Development Scripts** (AC: 9)
  - [ ] Verify `"dev": "next dev"` in package.json
  - [ ] Add `"build": "next build"`
  - [ ] Add `"start": "next start"`
  - [ ] Add `"lint": "next lint"`
  - [ ] Test all scripts work correctly

- [ ] **Test Frontend Application** (AC: 9)
  - [ ] Start frontend: `pnpm dev`
  - [ ] Verify app runs on port 3000
  - [ ] Open http://localhost:3000 in browser
  - [ ] Verify home page renders correctly
  - [ ] Test navigation and footer display
  - [ ] Test hot reload (modify component and check)
  - [ ] Verify Tailwind styles apply correctly
  - [ ] Test shadcn/ui components render

---

## Dev Notes

### Previous Story Insights

[Dependency: Story 1.4 - Setup NestJS Backend Skeleton]

Story 1.4 established:

- NestJS API running on port 3001
- Health check endpoint at /health
- CORS configured for http://localhost:3000

This story creates the Next.js frontend that will consume the API.

### Next.js Framework Configuration

[Source: architecture/tech-stack.md#nextjs-14]

**Next.js 14+** with App Router:

- Version: 14.0.0 or later
- Built-in SSR/SSG for better SEO
- App Router for modern React patterns (Server Components, Streaming)
- Image optimization out of the box
- Fast Refresh for great developer experience

**Installation command:**

```bash
pnpm create next-app@latest frontend
```

Select options:

- ✅ TypeScript
- ✅ ESLint
- ✅ Tailwind CSS
- ✅ `src/` directory
- ✅ App Router
- ❌ Import alias (we'll configure custom)

### Project Structure

[Source: architecture/source-tree.md#frontend-structure]

**Initial frontend structure:**

```
apps/frontend/
├── src/
│   ├── app/
│   │   ├── layout.tsx         # Root layout
│   │   ├── page.tsx           # Homepage
│   │   ├── loading.tsx        # Loading UI
│   │   └── error.tsx          # Error UI
│   ├── components/
│   │   ├── ui/                # shadcn/ui components
│   │   └── layout/            # Layout components
│   │       ├── navigation.tsx
│   │       └── footer.tsx
│   ├── lib/
│   │   ├── api/
│   │   │   └── client.ts      # Axios client
│   │   ├── utils.ts           # Utility functions (cn)
│   │   └── query-client.ts    # React Query config
│   ├── providers/
│   │   └── query-provider.tsx
│   ├── store/
│   │   └── auth.store.ts      # Zustand auth store
│   └── styles/
│       └── globals.css        # Global styles
├── public/
├── .env.local
├── .env.example
├── components.json            # shadcn/ui config
├── next.config.js
├── tailwind.config.js
├── tsconfig.json
└── package.json
```

### TypeScript Configuration

[Source: architecture/tech-stack.md#typescript-5]

**tsconfig.json for Next.js:**

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [{ "name": "next" }],
    "paths": {
      "@/*": ["./src/*"],
      "@recipe-wire/types": ["../../packages/types/src"],
      "@recipe-wire/utils": ["../../packages/utils/src"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

### Tailwind CSS Configuration

[Source: architecture/tech-stack.md#tailwind-css-3]

**tailwind.config.js:**

```javascript
/** @type {import('tailwindcss').Config} */
module.exports = {
  darkMode: ['class'],
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
    './src/app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        border: 'hsl(var(--border))',
        input: 'hsl(var(--input))',
        ring: 'hsl(var(--ring))',
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        primary: {
          DEFAULT: 'hsl(var(--primary))',
          foreground: 'hsl(var(--primary-foreground))',
        },
        secondary: {
          DEFAULT: 'hsl(var(--secondary))',
          foreground: 'hsl(var(--secondary-foreground))',
        },
      },
    },
  },
  plugins: [require('tailwindcss-animate')],
}
```

### shadcn/ui Configuration

[Source: architecture/tech-stack.md#shadcn-ui]

**Initialize shadcn/ui:**

```bash
pnpm dlx shadcn-ui@latest init
```

**Add components:**

```bash
pnpm dlx shadcn-ui@latest add button card input label
```

Components are copied to `src/components/ui/` (not installed as dependency).

### React Query Configuration

[Source: architecture/tech-stack.md#react-query-5]

**QueryClient setup (src/lib/query-client.ts):**

```typescript
import { QueryClient } from '@tanstack/react-query'

export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 60 * 1000, // 1 minute
      refetchOnWindowFocus: false,
      retry: 1,
    },
  },
})
```

**QueryProvider (src/providers/query-provider.tsx):**

```typescript
'use client'

import { QueryClientProvider } from '@tanstack/react-query'
import { ReactQueryDevtools } from '@tanstack/react-query-devtools'
import { queryClient } from '@/lib/query-client'

export function QueryProvider({ children }: { children: React.ReactNode }) {
  return (
    <QueryClientProvider client={queryClient}>
      {children}
      <ReactQueryDevtools initialIsOpen={false} />
    </QueryClientProvider>
  )
}
```

### Zustand Store Configuration

[Source: architecture/tech-stack.md#zustand-4]

**Auth store (src/store/auth.store.ts):**

```typescript
import { create } from 'zustand'
import { persist } from 'zustand/middleware'

interface User {
  id: string
  email: string
  displayName: string
}

interface AuthState {
  user: User | null
  token: string | null
  isAuthenticated: boolean
  login: (user: User, token: string) => void
  logout: () => void
  setUser: (user: User) => void
}

export const useAuthStore = create<AuthState>()(
  persist(
    set => ({
      user: null,
      token: null,
      isAuthenticated: false,
      login: (user, token) => set({ user, token, isAuthenticated: true }),
      logout: () => set({ user: null, token: null, isAuthenticated: false }),
      setUser: user => set({ user }),
    }),
    {
      name: 'auth-storage',
    }
  )
)
```

### API Client Configuration

[Source: architecture/source-tree.md#frontend-structure]

**Axios client (src/lib/api/client.ts):**

```typescript
import axios from 'axios'
import { useAuthStore } from '@/store/auth.store'

const apiClient = axios.create({
  baseURL: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001',
  headers: {
    'Content-Type': 'application/json',
  },
})

// Request interceptor - add auth token
apiClient.interceptors.request.use(config => {
  const token = useAuthStore.getState().token
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

// Response interceptor - handle errors
apiClient.interceptors.response.use(
  response => response,
  error => {
    if (error.response?.status === 401) {
      useAuthStore.getState().logout()
    }
    return Promise.reject(error)
  }
)

export default apiClient
```

### Root Layout Configuration

[Source: architecture/source-tree.md#frontend-structure]

**Root layout (src/app/layout.tsx):**

```typescript
import type { Metadata } from 'next'
import { Inter } from 'next/font/google'
import { QueryProvider } from '@/providers/query-provider'
import Navigation from '@/components/layout/navigation'
import Footer from '@/components/layout/footer'
import './globals.css'

const inter = Inter({ subsets: ['latin'] })

export const metadata: Metadata = {
  title: 'RecipeWire - Share Your Recipes',
  description: 'A platform for sharing and discovering recipes'
}

export default function RootLayout({
  children
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body className={inter.className}>
        <QueryProvider>
          <div className="flex min-h-screen flex-col">
            <Navigation />
            <main className="flex-1">{children}</main>
            <Footer />
          </div>
        </QueryProvider>
      </body>
    </html>
  )
}
```

### Environment Variables

[Source: prd/epic-1-project-setup.md#story-1.5]

**.env.local:**

```
NEXT_PUBLIC_API_URL=http://localhost:3001
```

**.env.example:**

```
# API Configuration
NEXT_PUBLIC_API_URL=http://localhost:3001
```

### Testing

[Source: architecture/coding-standards.md#testing-standards]

**Manual Testing Required:**

1. Verify Next.js installed: Check `apps/frontend/package.json`
2. Verify TypeScript strict mode: Check `tsconfig.json`
3. Start frontend: `pnpm dev`
4. Verify app runs on port 3000
5. Open http://localhost:3000 in browser
6. Verify home page renders with content
7. Verify navigation component displays
8. Verify footer component displays
9. Test hot reload: Modify page.tsx and verify changes
10. Verify Tailwind styles apply (check colors, spacing)
11. Verify shadcn/ui components render (Button, Card)
12. Test React Query Devtools appear (bottom left icon)
13. Verify environment variable loads: Check NEXT_PUBLIC_API_URL
14. Test responsive design (resize browser)

**No automated tests required** for this infrastructure story. Component tests will be added in Epic 6.

---

## Change Log

| Date       | Version | Description            | Author             |
| ---------- | ------- | ---------------------- | ------------------ |
| 2025-09-30 | 1.0     | Initial story creation | Scrum Master (Bob) |

---

## Dev Agent Record

### Agent Model Used

_To be filled by Dev Agent during implementation_

### Debug Log References

_To be filled by Dev Agent during implementation_

### Completion Notes List

_To be filled by Dev Agent during implementation_

### File List

_To be filled by Dev Agent during implementation_

---

## QA Results

_To be filled by QA Agent after implementation_
